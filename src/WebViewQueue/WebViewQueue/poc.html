<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="https://cdn.jsdelivr.net/bluebird/3.4.5/bluebird.js"></script>
    </head>
    <body>x 
        <p>Test</p>
        <script>
            function ping() {
                console.log("ping received")
            }
            
            function someLongRunningProcess(pid) {
                Promise.delay(0).then(function() {
                    window.webkit.messageHandlers.continueHandler.postMessage({"pid":pid})
                })
            }
        
            function getRandomInt(min, max) {
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }
        
            function delay(ms) {
                var cur_d = new Date();
                var cur_ticks = cur_d.getTime();
                var ms_passed = 0;
                while(ms_passed < ms) {
                    var d = new Date();
                    var ticks = d.getTime();
                    ms_passed = ticks - cur_ticks;
                }
            }
        
            //var counter = 0
            //var func = null
            //func = function() {
            //    counter++
            //    window.webkit.messageHandlers.continueHandler.postMessage({"jsHeartbeat":counter})
            //    setTimeout(func, 1000)
            //}
            //func()
        </script>
    </body>
</html>
</html>